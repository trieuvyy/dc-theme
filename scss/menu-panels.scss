/* 
Figma Community Forum
Menu panels
------------------------

"Menu panels" consist of any of the dropdown menus that are triggered
from buttons in the header. These are, from left-to-right:

• Search menu
• Hamburger panel
• User menu

They have a general purpose styling, but based on need or mock-up, 
one or two things have been individually configured for these.

------------------------
*/

/* This is a class Discourse bestows upon your whole page if your menu
items trigger a dropdown */
.menu-panel {
  &.user-menu.revamped {
    width: unset;
  }

  .panel-body {
    max-height: calc(100vh - 100px);
  }
}

// Sidebar-hamburger hybrid

.hamburger-panel .revamped {
  --d-sidebar-highlight-background: var(--d-hover);
  --d-sidebar-row-horizontal-padding: 0.5rem;
  --d-sidebar-row-height: 30px;
  // 1.25rem gets text left-aligned with the hamburger icon
  --d-sidebar-row-horizontal-padding: 0.66rem;
  width: 360px;

  .panel-body-content {
    width: 100%;
    min-width: 0; // prevent content blowing out width
  }

  .sidebar-section-wrapper {
    .sidebar-section-header-button {
      opacity: 1;
    }

    .sidebar-section-link.active {
      font-weight: normal;
      background: var(--d-hover);
    }

    .sidebar-section-header-wrapper .select-kit .btn:hover {
      background: transparent;
    }

    &.sidebar-section {
      padding-top: 0.5em;
      .sidebar-section-header-wrapper {
        margin: 0 0 0.5em;
        padding-bottom: 0.25em;
        border-bottom: 1px solid var(--primary-low);
        .d-icon-globe {
          color: var(--primary-medium);
        }
      }
      ul {
        display: grid;
        grid-template-columns: 1fr 1fr;
        li {
          min-width: 0;
        }
      }
    }

    .sidebar-section-message {
      padding: 0;
    }
  }

  .sidebar-section-link-wrapper
    .sidebar-section-link-hover:hover
    .sidebar-section-hover-button {
    background: transparent;
  }

  .sidebar-footer-wrapper {
    padding: 0;
    margin-top: 1em;
    .sidebar-footer-container {
      padding: 0;
      border: none;
      background: var(--secondary);
      &:before {
        top: -1.5em;
        background: linear-gradient(
          to bottom,
          transparent,
          rgba(var(--secondary-rgb), 1)
        );
      }
    }
  }
}

.sidebar-hamburger-dropdown {
  .discourse-no-touch & {
    .sidebar-section-wrapper .sidebar-section-header-wrapper:hover,
    .sidebar-section-wrapper .sidebar-section-header-wrapper:focus-within {
      background: transparent;
    }
  }
}


/* Search menu */
.search-menu {
  input[type="text"] {
    font-size: 1em;
    font-weight: 400;
    margin-bottom: 0px;
    padding: 8px 8px;
    height: revert;
    width: 100%;
    &::placeholder {
      color: var(--fg-medium-contrast);
    }
  }
  .menu-panel {
    /* This specialized padding is "fixed" by .results on the
        bottom of the div */
    padding: 16px 16px 6px 16px;
  }
  .search-context {
    margin-bottom: 6px;
    order: 1;
    padding: 0 0;
    .d-label {
      color: var(--fg-medium-contrast);
      font-size: 0.875em;
      font-weight: 500;
      text-decoration: underline;
      text-transform: capitalize;
    }
    & + .results {
      margin-top: 0;
    }
  }
  .search-input {
    margin-bottom: 16px;
    padding: 0 0;
    order: 2;
  }
  .searching {
    top: 8px !important;
    right: 8px !important;
    // these are icons displayed in the right corner of the search bar
    a.show-advanced-search, a.clear-search { 
      .d-icon {
        color: var(--fg-low-contrast);
      }
      &:hover {
        .d-icon {
          color: var(--fg-high-contrast);
        }
      }
    }
  }
  .results {
    margin-top: 0;
    order: 3;
    padding-bottom: 10px;
    .search-result-topic {
      width: 100%;
    }
    .main-results + .secondary-results {
      border-left: 1px solid var(--surface-high-contrast);
      margin-left: 1em;
      margin-right: 1em;
      padding-left: 1em;
      padding-right: 1em;
    }
    .extra-hint {
      color: var(--fg-low-contrast);
    }
  }
  /* Positions the spinner correctly in the middle */
  .searching {
    right: 1.25em;
    top: 1em;
  }
}

/* User menu */
.user-menu {
  .menu-links-header {
    border-bottom: 1px solid #dadada;
    padding-bottom: 4px;
    margin-bottom: 4px;
    button {
      .active {
        border-bottom: 0;
      }
      &:hover.active, &:focus.active {
        background-color: transparent;
      }
    }
  }
  .menu-links-row {
    .glyphs {
      button {
        background: transparent;
        color: var(--fg-low-contrast);
        .d-icon {
          color: var(--fg-low-contrast);
        }
        &.active {
          border: 0px !important;
          color: var(--fg-high-contrast);
          .d-icon {
            color: var(--fg-high-contrast);
          }
        }
        &:hover {
          background-color: transparent !important;
          .d-icon {
            color: var(--fg-high-contrast);
          }
        }
      }
    }
  }
  .quick-access-panel {
    border-top: 0;
    margin-top: 0;
    padding: 16px 0px 0px 0px;
    ul {
      display: block;
      flex-flow: revert;
    }
    li,
    li:not(.show-all) {
      background-color: transparent;
      color: var(--fg-medium-contrast);
      display: block;
      font-size: 0.875em;
      margin-bottom: 4px;
      padding: 4px 12px;
      &:hover {
        background-color: var(--community-blue) !important;
        color: white !important;
        cursor: pointer;
        a, span, .d-icon {
          color: white !important;
        }
      }
      &:last-of-type {
        margin-bottom: 0;
      }
      &.is-warning {
        .d-icon {
          color: var(--red);
        }
      }
      button {
        all: unset;
      }
      a, button {
        color: var(--fg-high-contrast);
        column-gap: 8px;
        display: inline-grid !important;
        font-size: 1em;
        grid-template-columns: 6px 16px 1fr;
        margin: 0;
        padding: 0 0;
        vertical-align: text-bottom;
        svg {
          grid-column: 2;
        }
        div {
          grid-column: 3;
          width: 100%;
        }
      }
      &:not(.read) {
        background-color: transparent;
        a:before {
          @include dot(var(--red), 6px);
          content: "";
          display: block;
          margin-top: 6px;
        }
      }
      span {
        &:first-child {
          color: var(--fg-high-contrast);
          font-weight: 500;
          &:after {
            color: inherit;
            content: "›";
            display: inline-block;
            font-weight: 400;
            margin: 0 0px 0px 4px;
            opacity: 0.8;
          }
        }
        &:last-child {
          font-weight: 400;
          &:after {
            content: none;
          }
        }
      }
      .d-icon {
        align-self: flex-start;
        color: var(--fg-medium-contrast);
        font-size: 16px;
        margin-right: 8px;
        margin-top: 2px;
        padding-top: 0;
      }
    }
    .read {
      background-color: transparent;
      color: var(--fg-high-contrast);
      a {
        color: var(--fg-high-contrast);
      }
    }
  }
  #quick-access-notifications {
    li.read {
      display: none;
    }
  }
}

#topic-entrance {
  @include hud-shadow();
  display: inline-flex;
  flex-direction: column;
  flex-wrap: wrap;
  padding: 16px 0;
  transform: translateY(56px);
  min-width: 160px;
  button.btn.jump-bottom {
    margin: 0 0;
  }
  button.full {
    background-color: transparent;
    border-radius: 0;
    color: var(--modal-fg);
    flex-wrap: nowrap;
    justify-content: flex-start;
    margin-bottom: 0px;
    padding: 5px 24px;
    text-transform: none;
    transition: color 0s;
    width: 100%; 
    &:hover, &:focus {
      background-color: var(--community-blue);
      color: var(--bold-fg);
    }
    br {
      display: none;
    }
    .d-icon {
      color: inherit;
      font-size: 12px;
      margin: 0px 8px 0px -8px;
      order: -1;
      transition: color 0s;
      width: 12px;
    }
  }
}
